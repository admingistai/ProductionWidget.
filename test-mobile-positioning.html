<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üì± Mobile Widget Positioning Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
            min-height: 100vh;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }
        
        .test-info {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #2196f3;
        }
        
        .mobile-simulator {
            background: #333;
            border-radius: 25px;
            padding: 20px;
            margin: 20px 0;
            max-width: 375px;
            height: 600px;
            position: relative;
            overflow: hidden;
            border: 8px solid #333;
        }
        
        .mobile-screen {
            background: white;
            height: 100%;
            border-radius: 15px;
            position: relative;
            overflow: hidden;
        }
        
        .measurement-guide {
            position: absolute;
            bottom: 0;
            right: 10px;
            background: rgba(255, 255, 255, 0.9);
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 12px;
            border: 1px solid #ddd;
        }
        
        .device-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .info-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #e9ecef;
        }
        
        .checklist {
            background: #f0fff4;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #4caf50;
            margin: 20px 0;
        }
        
        .checklist h3 {
            color: #2e7d32;
            margin-top: 0;
        }
        
        .check-item {
            margin: 8px 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .check-item::before {
            content: "‚úì";
            color: #4caf50;
            font-weight: bold;
            font-size: 16px;
        }
        
        .resize-controls {
            background: #fff3e0;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #ff9800;
        }
        
        .resize-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 10px;
        }
        
        .resize-btn {
            padding: 8px 16px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }
        
        .resize-btn:hover {
            background: #f5f5f5;
            transform: translateY(-1px);
        }
        
        .resize-btn.active {
            background: #2196f3;
            color: white;
            border-color: #2196f3;
        }
        
        .current-viewport {
            font-weight: bold;
            color: #1976d2;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üì± Mobile Widget Positioning Test</h1>
        
        <div class="test-info">
            <h3>üéØ Test Objective</h3>
            <p><strong>Verify that the widget sits 10px lower on mobile devices for better thumb accessibility.</strong></p>
            <ul>
                <li><strong>Mobile</strong> (&lt; 600px): Widget bottom = 10px</li>
                <li><strong>Desktop</strong> (‚â• 600px): Widget bottom = 20px</li>
            </ul>
        </div>
        
        <div class="resize-controls">
            <h3>üîÑ Responsive Testing</h3>
            <p>Click buttons to simulate different screen sizes and watch the widget position change:</p>
            <div class="resize-buttons">
                <button class="resize-btn" onclick="setViewport(320, 568, 'iPhone SE')">iPhone SE (320px)</button>
                <button class="resize-btn" onclick="setViewport(375, 667, 'iPhone 8')">iPhone 8 (375px)</button>
                <button class="resize-btn" onclick="setViewport(414, 896, 'iPhone 11')">iPhone 11 (414px)</button>
                <button class="resize-btn" onclick="setViewport(600, 854, 'Mobile Boundary')">600px (Boundary)</button>
                <button class="resize-btn" onclick="setViewport(768, 1024, 'Tablet')">Tablet (768px)</button>
                <button class="resize-btn" onclick="setViewport(1200, 800, 'Desktop')">Desktop (1200px)</button>
            </div>
            <div class="current-viewport" id="current-viewport">
                Current: <span id="viewport-size">Auto-detected</span>
            </div>
        </div>
        
        <div class="device-info">
            <div class="info-card">
                <h4>üìè Current Screen</h4>
                <div>Width: <span id="screen-width">-</span>px</div>
                <div>Height: <span id="screen-height">-</span>px</div>
                <div>Device: <span id="device-type">-</span></div>
            </div>
            
            <div class="info-card">
                <h4>üéØ Widget Position</h4>
                <div>Bottom Distance: <span id="widget-bottom">-</span>px</div>
                <div>Expected: <span id="expected-bottom">-</span>px</div>
                <div>Status: <span id="position-status">-</span></div>
            </div>
        </div>
        
        <div class="checklist">
            <h3>‚úÖ Test Checklist</h3>
            <div class="check-item">Widget appears at bottom of screen</div>
            <div class="check-item">Mobile devices show widget 10px from bottom</div>
            <div class="check-item">Desktop devices show widget 20px from bottom</div>
            <div class="check-item">Smooth transition when resizing window</div>
            <div class="check-item">Widget remains clickable and functional</div>
            <div class="check-item">No visual artifacts or positioning glitches</div>
        </div>
        
        <div style="height: 100px; background: #f9f9f9; border-radius: 8px; display: flex; align-items: center; justify-content: center; margin: 40px 0; color: #666;">
            <p>üëÜ Content area - Widget should appear at bottom of viewport regardless of page content</p>
        </div>
    </div>
    
    <!-- Load the updated widget -->
    <script src="./dist/widget.iife.js" defer></script>
    
    <script>
        let currentDevice = '';
        
        function updateDisplayInfo() {
            const width = window.innerWidth;
            const height = window.innerHeight;
            const isMobile = width < 600;
            const isTablet = width >= 600 && width < 768;
            const isDesktop = width >= 768;
            
            let deviceType = 'Unknown';
            if (isMobile) deviceType = 'Mobile';
            else if (isTablet) deviceType = 'Tablet';
            else if (isDesktop) deviceType = 'Desktop';
            
            document.getElementById('screen-width').textContent = width;
            document.getElementById('screen-height').textContent = height;
            document.getElementById('device-type').textContent = deviceType;
            
            // Expected bottom position based on our implementation
            const expectedBottom = isMobile ? 10 : 20;
            document.getElementById('expected-bottom').textContent = expectedBottom;
            
            // Try to detect actual widget position
            setTimeout(() => {
                const widget = document.querySelector('[style*="bottom"]');
                if (widget) {
                    const computedStyle = window.getComputedStyle(widget);
                    const actualBottom = parseInt(computedStyle.bottom) || 0;
                    document.getElementById('widget-bottom').textContent = actualBottom;
                    
                    const isCorrect = actualBottom === expectedBottom;
                    const statusEl = document.getElementById('position-status');
                    statusEl.textContent = isCorrect ? '‚úÖ Correct' : '‚ùå Incorrect';
                    statusEl.style.color = isCorrect ? '#4caf50' : '#f44336';
                } else {
                    document.getElementById('widget-bottom').textContent = 'Not found';
                    document.getElementById('position-status').textContent = '‚è≥ Loading...';
                }
            }, 1000);
            
            if (currentDevice) {
                document.getElementById('viewport-size').textContent = `${currentDevice} (${width}√ó${height})`;
            } else {
                document.getElementById('viewport-size').textContent = `${width}√ó${height} (${deviceType})`;
            }
        }
        
        function setViewport(width, height, deviceName) {
            // Update active button
            document.querySelectorAll('.resize-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Simulate viewport size by resizing window (if possible) or showing info
            currentDevice = deviceName;
            
            // For demonstration, we'll just update the display
            // In a real test, you'd need to physically resize the browser window
            const resizeWarning = width < window.innerWidth ? 
                `\n\nüìù Note: Please manually resize your browser window to ${width}px width to see the actual positioning change.` : '';
                
            alert(`Testing ${deviceName} viewport (${width}√ó${height})${resizeWarning}`);
            updateDisplayInfo();
        }
        
        // Update info on page load and resize
        window.addEventListener('load', updateDisplayInfo);
        window.addEventListener('resize', updateDisplayInfo);
        
        // Initial update
        updateDisplayInfo();
        
        console.log('üì± Mobile Positioning Test loaded. Resize window to test responsive positioning.');
    </script>
</body>
</html>