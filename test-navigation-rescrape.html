<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Navigation Re-scraping - Page 1</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 40px 20px;
            line-height: 1.6;
        }
        h1 {
            color: #333;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
        }
        .navigation {
            display: flex;
            gap: 20px;
            margin: 30px 0;
            padding: 20px;
            background: #f5f5f5;
            border-radius: 8px;
        }
        .nav-button {
            padding: 10px 20px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            text-decoration: none;
            font-size: 14px;
        }
        .nav-button:hover {
            background: #0056b3;
        }
        .content {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .page-indicator {
            background: #28a745;
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            display: inline-block;
            margin-bottom: 20px;
        }
        .debug-info {
            position: fixed;
            top: 10px;
            right: 10px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            max-width: 300px;
        }
    </style>
</head>
<body>
    <div class="debug-info">
        <div>Current URL: <span id="current-url"></span></div>
        <div>Page ID: <span id="page-id">page-1</span></div>
        <div>Navigation Count: <span id="nav-count">0</span></div>
    </div>

    <h1>Widget Navigation Test - Page 1</h1>
    
    <div class="navigation">
        <button class="nav-button" onclick="navigateToPage('page-1')">Page 1 (Products)</button>
        <button class="nav-button" onclick="navigateToPage('page-2')">Page 2 (Services)</button>
        <button class="nav-button" onclick="navigateToPage('page-3')">Page 3 (Pricing)</button>
        <button class="nav-button" onclick="navigateToPage('page-4')">Page 4 (About Us)</button>
    </div>

    <div class="content" id="page-content">
        <div class="page-indicator">Page 1 - Product Catalog</div>
        
        <h2>Our Premium Products</h2>
        <p>Welcome to our product catalog page. This page contains information about our amazing products.</p>
        
        <h3>Featured Products:</h3>
        <ul>
            <li><strong>Product Alpha</strong> - Revolutionary AI-powered solution for $299/month</li>
            <li><strong>Product Beta</strong> - Advanced analytics platform for $199/month</li>
            <li><strong>Product Gamma</strong> - Enterprise collaboration suite for $499/month</li>
        </ul>
        
        <h3>Product Details</h3>
        <p>All our products come with:</p>
        <ul>
            <li>24/7 customer support</li>
            <li>30-day money-back guarantee</li>
            <li>Free setup and onboarding</li>
            <li>Regular updates and improvements</li>
        </ul>
        
        <p>Special offer: Use code SAVE20 for 20% off your first month!</p>
    </div>

    <!-- Load the widget -->
    <script src="widget-deploy/widget.js" defer></script>

    <script>
        // Page content for different pages
        const pageContents = {
            'page-1': {
                title: 'Widget Navigation Test - Page 1',
                indicator: 'Page 1 - Product Catalog',
                content: `
                    <h2>Our Premium Products</h2>
                    <p>Welcome to our product catalog page. This page contains information about our amazing products.</p>
                    
                    <h3>Featured Products:</h3>
                    <ul>
                        <li><strong>Product Alpha</strong> - Revolutionary AI-powered solution for $299/month</li>
                        <li><strong>Product Beta</strong> - Advanced analytics platform for $199/month</li>
                        <li><strong>Product Gamma</strong> - Enterprise collaboration suite for $499/month</li>
                    </ul>
                    
                    <h3>Product Details</h3>
                    <p>All our products come with:</p>
                    <ul>
                        <li>24/7 customer support</li>
                        <li>30-day money-back guarantee</li>
                        <li>Free setup and onboarding</li>
                        <li>Regular updates and improvements</li>
                    </ul>
                    
                    <p>Special offer: Use code SAVE20 for 20% off your first month!</p>
                `
            },
            'page-2': {
                title: 'Widget Navigation Test - Page 2',
                indicator: 'Page 2 - Professional Services',
                content: `
                    <h2>Professional Services</h2>
                    <p>Our expert team provides comprehensive services to help your business succeed.</p>
                    
                    <h3>Available Services:</h3>
                    <ul>
                        <li><strong>Consulting</strong> - Strategic business consulting at $500/hour</li>
                        <li><strong>Implementation</strong> - Full system implementation starting at $10,000</li>
                        <li><strong>Training</strong> - Custom training programs from $2,000/day</li>
                        <li><strong>Support</strong> - Premium support packages from $1,000/month</li>
                    </ul>
                    
                    <h3>Service Benefits</h3>
                    <p>When you choose our services, you get:</p>
                    <ul>
                        <li>Dedicated account manager</li>
                        <li>Customized solutions for your needs</li>
                        <li>Guaranteed response times</li>
                        <li>Quarterly business reviews</li>
                    </ul>
                    
                    <p>Contact us today for a free consultation!</p>
                `
            },
            'page-3': {
                title: 'Widget Navigation Test - Page 3',
                indicator: 'Page 3 - Pricing Plans',
                content: `
                    <h2>Flexible Pricing Plans</h2>
                    <p>Choose the perfect plan for your business needs.</p>
                    
                    <h3>Pricing Tiers:</h3>
                    <ul>
                        <li><strong>Starter Plan</strong> - Perfect for small teams at $99/month</li>
                        <li><strong>Professional Plan</strong> - For growing businesses at $299/month</li>
                        <li><strong>Enterprise Plan</strong> - Custom pricing for large organizations</li>
                    </ul>
                    
                    <h3>All Plans Include:</h3>
                    <ul>
                        <li>Unlimited users</li>
                        <li>SSL certificate</li>
                        <li>99.9% uptime guarantee</li>
                        <li>API access</li>
                        <li>Data export capabilities</li>
                    </ul>
                    
                    <p>Annual billing saves you 20%! Contact sales for volume discounts.</p>
                `
            },
            'page-4': {
                title: 'Widget Navigation Test - Page 4',
                indicator: 'Page 4 - About Our Company',
                content: `
                    <h2>About Us</h2>
                    <p>Founded in 2020, we're a leading provider of innovative business solutions.</p>
                    
                    <h3>Company Information:</h3>
                    <ul>
                        <li><strong>Headquarters</strong> - San Francisco, California</li>
                        <li><strong>Employees</strong> - Over 500 team members worldwide</li>
                        <li><strong>Customers</strong> - Serving 10,000+ businesses globally</li>
                        <li><strong>Revenue</strong> - $100M+ annual revenue</li>
                    </ul>
                    
                    <h3>Our Mission</h3>
                    <p>We empower businesses to achieve their full potential through innovative technology and exceptional service.</p>
                    
                    <h3>Core Values:</h3>
                    <ul>
                        <li>Innovation and creativity</li>
                        <li>Customer success</li>
                        <li>Integrity and transparency</li>
                        <li>Continuous improvement</li>
                    </ul>
                    
                    <p>Join us on our journey to transform the business world!</p>
                `
            }
        };

        let navigationCount = 0;

        // Function to navigate to different pages (SPA-style)
        function navigateToPage(pageId) {
            const page = pageContents[pageId];
            if (!page) return;

            // Update the page content
            document.title = page.title;
            document.getElementById('page-content').innerHTML = `
                <div class="page-indicator">${page.indicator}</div>
                ${page.content}
            `;

            // Update debug info
            document.getElementById('page-id').textContent = pageId;
            navigationCount++;
            document.getElementById('nav-count').textContent = navigationCount;

            // Change URL using pushState (this should trigger our widget's navigation detection)
            const newUrl = `${window.location.pathname}#${pageId}`;
            window.history.pushState({ page: pageId }, page.title, newUrl);
            
            console.log(`🎯 Navigated to ${pageId} - Widget should re-scrape content now!`);
        }

        // Handle browser back/forward buttons
        window.addEventListener('popstate', (event) => {
            const pageId = event.state?.page || 'page-1';
            const page = pageContents[pageId];
            if (page) {
                document.title = page.title;
                document.getElementById('page-content').innerHTML = `
                    <div class="page-indicator">${page.indicator}</div>
                    ${page.content}
                `;
                document.getElementById('page-id').textContent = pageId;
                console.log(`🔙 Browser navigation to ${pageId} - Widget should re-scrape!`);
            }
        });

        // Update current URL display
        function updateUrlDisplay() {
            document.getElementById('current-url').textContent = window.location.href;
        }
        
        updateUrlDisplay();
        setInterval(updateUrlDisplay, 100);

        // Initialize with page-1 in history
        window.history.replaceState({ page: 'page-1' }, 'Widget Navigation Test - Page 1', window.location.pathname + '#page-1');
    </script>
</body>
</html>